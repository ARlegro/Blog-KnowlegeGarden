---
{"dg-publish":true,"permalink":"/Computer_Science/C언어, 자료구조, 알고리즘/자동할당_동적할당/","noteIcon":"","created":"2025-08-11T17:35:50.934+09:00","updated":"2025-08-18T01:05:06.346+09:00"}
---




크래프톤 정글 Week05 커리큘럼 도중 팀원의 코드를 보다가 특정 구조체를 생성했는데 왜 free()를 안 적으셨지? 에 대해서 물어보았다. 팀원분도 나처럼 C가 처음이라 잘 모르겠다고 답변을 하셔서 서로 찾아보다가 C에서 구조체에 메모리를 할당하는 2가지 방식이 있다는 것을 알게되어 두 할당 방법(자동할당 vs 동적할당)에 대해 공부하게 되었다.

>[!tip]  주요 차이 (자동할당 vs 동적할당)
>1. 어디에 메모리가 할당되는지
>2. 언제 해제되는지

### 1. 동적 메모리 할당(내가 했던)
```C
   BTNode *newNode = malloc(sizeof(BTNode));
    newNode->item = item;
    newNode->left = NULL;
    newNode->right = NULL;
```    
- 포인터 변수 `newNode`에 malloc() 함수를 통해 메모리가 할당했다.
- 근데, 이 방식은 몇 가지 특징이 있다.
	1. `malloc`은 **힙(Heap)** 영역에 메모리를 할당한다.
	2. 반드시 `free(queue)`를 호출하여 메모리 참조를 해제해야 한다.그렇지 않으면 **메모리 누수** 발생.
		- 이 이유는 이 구조체 포인터를 생성시킨 함수가 종료되더라도 힙 영역에는 메모리가 남아있기 때문 
	  

### 2. 정적 메모리 할당(팀원이 했던)
```C
BTNode newNode;
newNode.item = item;
newNode.left = NULL;
newNode.right = NULL;
```
- **자동 메모리 할당** (지역변수)
- 이 경우 `newNode`는 포인터가 아니라 **Queue 구조체 자체**
- 주요 특징 
	1. *자동 할당* : 함수가 시작되면 이 구조체에 메모리가 **"스택"영역으로 할당된다 Cuz 지역변수** ⭐
	2. *자동 해제* : 함수가 종료되면 **자동으로 메모리 해제**됩니다. `free` 필요 없음 Cuz 함수 스택이 사라지면 그 안에 있는 지역변수들이 사라지는 데 그 중 하나가 바로 저 `newNode`이다.
  
> Point : 함수 시작 시 자동 할당, 함수 종료 시 자동 해제 


### 언제 어떤 할당 방법을 쓰는가?
- **함수 내부에서만** 쓰고 **함수 종료 후 버려질 구조체**라면 → 자동 할당 
- **크기가 크거나**, **함수 종료 후에도 다른 곳에서 계속 써야 한다면** → 동적 할당(`malloc`)