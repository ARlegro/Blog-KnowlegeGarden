---
{"dg-publish":true,"permalink":"/Computer_Science/Network/C-Network/Tiny ì›¹ ì„œë²„ êµ¬í˜„/","noteIcon":"","created":"2025-12-03T14:52:46.150+09:00","updated":"2025-12-13T18:25:26.820+09:00"}
---


ì°¸ê³ 
- [[Computer_Science/Network/ê°œë…/Socket ê°œë…ê³¼ ê°„ë‹¨í•œ ì—ì½” ì„œë²„\|Socket ê°œë…ê³¼ ê°„ë‹¨í•œ ì—ì½” ì„œë²„]]
- [[Computer_Science/Network/ê°œë…/OSI 7 Layer\|OSI 7 Layer]]
- [[Computer_Science/Network/ê°œë…/TCP.IP 4ê³„ì¸µ ëª¨ë¸\|TCP.IP 4ê³„ì¸µ ëª¨ë¸]]
- ê¹ƒ í—ˆë¸Œ : https://github.com/ARlegro/web-server-impl

---
### ì£¼ìš” í•¨ìˆ˜ ì •ë¦¬ 

---
#### doit(int fd)
> ì—­í•  : í•˜ë‚˜ì˜ HTTP íŠ¸ëœì­ì…˜ì„ ì²˜ë¦¬ 

ê³¼ì • 
1. *ìš”ì²­ë¼ì¸ì„ ì½ëŠ”ë‹¤.*
2. *GET ë©”ì„œë“œì¸ì§€ í™•ì¸*
	- ğŸ’šGET ë©”ì„œë“œë¼ë©´ â¡ 3ë²ˆ ì§„í–‰
	- ğŸ˜GET ë©”ì„œë“œê°€ ì•„ë‹ˆë¼ë©´ : GET ë©”ì„œë“œë¥¼ ì œì™¸í•œ ë‹¤ë¥¸ ë©”ì„œë“œ ìš”ì²­ ì‹œ ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ê³  ë©”ì¸ ë£¨í‹´ìœ¼ë¡œ ëŒì•„ê°„ë‹¤(`doit()` ì¢…ë£Œ)
	  
3. *urië¥¼ íŒŒì‹±í•´ì„œ ì»¨í…ì¸ ì˜ ì¢…ë¥˜ íŒŒì•…(ë™ì  or ì •ì )*
	- `parse_uri(uri, filename, cgiargs)`ë¼ëŠ” URI ë¶„ì„ í—¬í¼ ë©”ì„œë“œë¥¼ ì‚¬ìš© 
		- `?x=1&y=3`ì´ëŸ°ê²Œ ë“¤ì–´ê°€ë©´ ë™ì ì¸ ê²ƒ 
		- return : ì •ì (1), ë™ì (0) 
		- *ì¶”ê°€ íš¨ê³¼* : filename, cgiargsë¥¼ uri, paramì„ ë°˜ì˜í•´ì„œ ì±„ì›Œë„£ì–´ì¤Œ
	  
4. *íŒŒì¼ì˜ ìƒíƒœ ì •ë³´(í¬ê¸°, ì¢…ë¥˜, ê¶Œí•œ ë“±)ì„ ì‚¬ì „ì— ì •ì˜í•œ êµ¬ì¡°ì²´ì— ì±„ì›Œì£¼ê¸°*
	- ì˜ˆì‹œ : `stat(filename, &sbuf)`
		- `/* Get file attributes for FILE and put them in BUF. Â */`
		- stat : ë¦¬ëˆ…ìŠ¤ í‘œì¤€ ì‹œìŠ¤í…œ ì½œ by `<sys/stat.h>`
		- ì‹¤íŒ¨ ì‹œ ìŒìˆ˜ ë°˜í™˜ : íŒŒì¼ì´ ì—†ê±°ë‚˜ ì ‘ê·¼ ë¶ˆê°€ì¸ ê²½ìš°
	- ì´ìœ  : ë‚˜ì¤‘ì— ì»¨í…ì¸  ì²˜ë¦¬ ì‹œ å¿…
	  
5. *ë™ì ìœ ë¬´ì— ë”°ë¼ í”Œë˜ê·¸ ë‚˜ëˆ ì„œ ì»¨í…ì¸  ì²˜ë¦¬ *
	1. *ì •ì  ì»¨í…ì¸ ì¸ ê²½ìš°*
		- ì¼ë°˜ íŒŒì¼ì´ê³  ì½ê¸° ê¶Œí•œì´ ìˆëŠ”ì§€ í™•ì¸
		- ë§Œì•½ ì¡°ê±´ì´ ë§ë‹¤ë©´ í´ë¼ì´ì–¸íŠ¸ì— ì½˜í…ì¸  ì œê³µ
		  
	2. *ë™ì  ì»¨í…ì¸ ì¸ ê²½ìš°*
		- íŒŒì¼ì´ ì‹¤í–‰ ê°€ëŠ¥í•œì§€ í™•ì¸
		- ë§Œì•½ ì¡°ê±´ì´ ë§ë‹¤ë©´ í´ë¼ì´ì–¸íŠ¸ì— ì½˜í…ì¸  ì œê³µ

---
#### clienterror(...)
```c
void clienterror(int fd, char *cause, char *errnum, char *shortmsg, char *longmsg);
```
ì¸ì
- fd : íŒŒì¼ ë””ìŠ¤í¬ë¦½ì…˜
- cause : ì›ì¸ 
- errnum : ìƒíƒœ ì½”ë“œ 

*ê³¼ì •* 
1. HTTP response bodyë¥¼ ë§Œë“ ë‹¤.
2. HTTP respsonseë¥¼ ì¶œë ¥í•œë‹¤.

---
#### read_requesthdrs()

> [!WARNING] ì°¸ê³  : Tiny ì„œë²„ëŠ” ìš”ì²­ í—¤ë”ì˜ ì–´ë–¤ ì •ë³´ë„ ì‚¬ìš© ì•ˆí•¨ 
> ê·¸ë˜ì„œ ì´ í•¨ìˆ˜ëŠ” ì½ê¸°ë§Œ í•˜ê³  ë¬´ì‹œ

```c
void read_requesthdrs(rio_t *rp)
// rp : í´ë¼ì´ì–¸íŠ¸ ì†Œì¼“ê³¼ ì—°ê²°ëœ ë²„í¼ ìƒíƒœ 
{ 
		char buf[MAXLINE]; 
		// ì²« ì¤„ ì½ê¸° : GET /index.html HTTP/1.1
		Rio_readlineb(rp, buf, MAXLINE); 

	  /**
		 * ë‚˜ë¨¸ì§€ ì¤„ ì½ê¸° 
		 * Host: localhost:8000
		 * User-Agent: Mozilla/5.0
		 * Accept: text/html
		 * ...
		 */
		while(strcmp(buf, "\r\n")) { 
			 Rio_readlineb(rp, buf, MAXLINE); 
			 printf("%s", buf); 
	  }
 
	  return; 
} 
```
`strcmp(buf, "\r\n")
- í˜„ì¬ ì½ì€ ì¤„ì´ ë¹ˆ ì¤„(`"\r\n"`)ì¸ì§€ í™•ì¸ 
- Rio_readlinebë³´ë‹¤ ë¨¼ì € ì¶œí˜„í•˜ë¯€ë¡œ ë¹ˆ ì¤„ì„ í•œë²ˆ ì½ê¸´í•œë‹¤. í—¤ë” ë§ˆì§€ë§‰ì— ë¹ˆì¤„ì„ í™•ì¸

---
#### parse_uri(uri, filename, cgiargs)
 > *ë©”ì¸ ì—­í• *: urië¥¼ íŒŒì‹±í•´ì„œ **ì»¨í…ì¸ ì˜ ì¢…ë¥˜ íŒŒì•…**(ë™ì  or ì •ì )
 > *ì¶”ê°€*: filename, cgiargsë¥¼ **uri, paramì„ ë°˜ì˜í•´ì„œ ì±„ì›Œ ë„£ì–´ì¤Œ**

>[!tip] ì •ì , ë™ì  íŒë‹¨ ê·¼ê±° 
>uriì— "cgi-bin"ë¬¸ìì—´ì´ **í¬í•¨ë˜ì–´ ìˆì§€ ì•Šìœ¼ë©´ ì •ì  ì»¨í…ì¸ **ë¡œ ê°„ì£¼
>- `?x=1&y=3`ì´ëŸ°ê²Œ ë“¤ì–´ê°€ë©´ cgië¬¸ìì—´ì´ ìˆì–´ì„œ ë™ì ì¸ ê²ƒ 


```C
// return : 1 - static, 0 - dynamic
int parse_uri(char *uri, char *filename, char *cgiargs){

Â  char *ptr;

Â  if (!strstr(uri, "cgi-bin/")){ Â /* ì •ì  ì»¨í…ì¸ ì¸ ê²½ìš°*/
Â  Â  strcpy(cgiargs, ""); // 1. cgiì¸ì ì´ˆê¸°í™”
Â  Â  strcpy(filename, ".");
Â  Â  strcat(filename, uri);

Â  Â  // ë§Œì•½ ê²½ë¡œê°€ '/'ë¡œ ëë‚˜ë©´ 'home.html'ê²½ë¡œ ì¶”ê°€
Â  Â  if (uri[strlen(uri)-1] == '/'){
Â  Â  Â  strcat(filename, "home.html"); // default page
Â  Â  }
Â  Â  return 1;
Â  }

Â  else { /* ë™ì  ì»¨í…ì¸ ì¸ ê²½ìš° */
Â  Â  // GET /cgi-bin/sum?k1=v1&k2=v2 Â  <<< dì´ ê²½ìš° ?ì´ ì²˜ìŒ ë‚˜ì˜¤ëŠ” ìœ„ì¹˜ì˜ ì¸ë±ìŠ¤
Â  Â  ptr = index(uri, "?");
Â  Â  if (ptr) {
Â  Â  Â  // ? ë’¤ì— ë‚˜ì˜¤ëŠ” ë¬¸ìë¥¼ cgiargsì— ì“°ê¸°
Â  Â  Â  strcpy(cgiargs, ptr+1);
Â  Â  Â  *ptr = '\0';
Â  Â  }
Â  Â  else {
Â  Â  Â  // cgiargs ì´ˆê¸°í™” - ì–´ì°¨í”¼ ì—†ìœ¼ë‹ˆ
Â  Â  Â  strcpy(cgiargs, "");
Â  Â  }
Â  Â  strcpy(filename, ".");
Â  Â  strcat(filename, uri);
Â  Â  return 0;
Â  }
```

ğŸ›‘*ì •ì  ì»¨í…ì¸ ì¸ ê²½ìš° *
1. *cgiargs ë¬¸ìì—´ì„ ë¹„ì›Œì¤€ë‹¤.* - `strcpy(cgiargs, "")`
	- ë™ì  ì»¨í…ì¸ ê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ì¿¼ë¦¬ ì¸ìê°€ í•„ìš”ê°€ ì—†ìŒ 
	  
2. *filenameì„ ì‘ì„±í•´ì¤Œ - `strcpy(filename, "."), strcat(filename, uri)`*
	- uriê°€ `/cgi-bin/sum` ì´ë©´ filenameì€ `.`ì„ ë¶™ì—¬ì„œ `./cgi-bin/sum` ì´ë ‡ê²Œ ë¨ 
	  
3. *Default ë¬¸ì„œ ì²˜ë¦¬*
	- uri ëì— `/`ê°€ ë¶™ìœ¼ë©´ `home.html` ê²½ë¡œ ì¶”ê°€ 

	  
âœˆ*ë™ì  ì»¨í…ì¸ ì¸ ê²½ìš°*
	1. *ì¿¼ë¦¬ ë¬¸ìì—´ ìœ„ì¹˜ íƒìƒ‰ - `index`*
	2. *cgiargs ì“°ê¸°*
	3. *filename ì‘ì„±í•´ì£¼ê¸°*

return : ì •ì (1), ë™ì (0) 

---
#### serve_static
> ì •ì  ì»¨í…ì¸  ë‹¤ë£¨ëŠ” í•¨ìˆ˜ 
> - ë™ì  ì»¨í…ì¸ ì™€ ë‹¬ë¦¬ í˜„ì¬ í”„ë¡œì„¸ìŠ¤ê°€ ì²˜ë¦¬ 

```c 
void serve_static(int fd, char *filename, int filesize){

Â  char filetype[MAXLINE], buf[MAXBUF];
Â  char *source_pointer;
Â  
Â  // 1 
Â  get_filetype(filename, filetype); 
Â 
Â  sprintf(buf, "HTTP/1.0 200 OK\r\n");
Â  sprintf(buf, "%sServer: Tiny Web Server\r\n", buf);
Â  sprintf(buf, "%sConnection: close\r\n", buf);
Â  sprintf(buf, "%sContent-length: %d\r\n", buf, filesize);
Â  sprintf(buf, "%sContent-type: %s\r\n\r\n", buf, filetype);
Â  // 2. í´ë¼ì´ì–¸íŠ¸ì— HTTP response header ë°ì´í„° ì „ì†¡
Â  Rio_writen(fd, buf, strlen(buf));

Â  printf("Response header:\n");
Â  printf("%s", buf);

	// 3. file Open -> ì‹ë³„ì ê°€ì ¸ì˜¤ê¸° 
Â  int source_descriptor = Open(filename, O_RDONLY, 0);

	// 4. fileì„ ê°€ìƒ ì£¼ì†Œ ê³µê°„ì— ë§¤í•‘ 
	// ì²˜ìŒ 0 = ë§¤í•‘í•  ë©”ëª¨ë¦¬ì˜ ì‹œì‘ ì£¼ì†Œë¥¼ íŒíŠ¸ë¡œ ì§€ì •
Â  source_pointer = Mmap(0, filesize, PROT_READ, MAP_PRIVATE, source_descriptor, 0);

	// 5. file ì‹ë³„ì ë‹«ê¸° 
Â  Close(source_descriptor);

	// 6. ì†Œì¼“ì— ë°”ë¡œ ì“°ê¸° (ê°€ìƒ ë©”ëª¨ë¦¬ ë§¤í•‘ ìƒíƒœ)
Â  Rio_writen(fd, source_pointer, filesize);

	// 7. ê°€ìƒ ë©”ëª¨ë¦¬ ë§¤í•‘í•œ ê²ƒ í•´ì œ : ë¦¬ì†ŒìŠ¤ ë°˜í™˜
Â  Munmap(source_pointer, filesize);
```

1. *íŒŒì¼ íƒ€ì…ì„ ì–»ëŠ”ë‹¤ - `get_filetype(filename, filetype)`*
2. *í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì‘ë‹µ í—¤ë”ë¥¼ ë³´ë‚¸ë‹¤*
	- sprintì™€ bufë¥¼ í™œìš©í•´ì„œ ëˆ„ì í•˜ê³  ë§ˆì§€ë§‰ì— Rio_writen ë°©ì‹ ã„± 
	- ë§ˆì§€ë§‰ì—ëŠ” ë¹ˆì¤„ ë§Œë“¤ì–´ì•¼ í•´ì„œ `\r\n\r\n`
	  
3. *fileì„ ì˜¤í”ˆí•˜ì—¬ ì‹ë³„ìë¥¼ ì–»ì–´ì˜¨ë‹¤* - `Open(const char *filename, int flags, mode_t mode)`
	- ì‹ë³„ìë¥¼ ê³§ë°”ë¡œ ì‚¬ìš©í•˜ì§€ëŠ” ì•Šì„ê±°ê³  4ë²ˆì„ ìœ„í•œ ì´ˆì„ 
	  
4. *fileì„ í”„ë¡œì„¸ìŠ¤ ê°€ìƒì£¼ì†Œê³µê°„ì— ë°”ë¡œ ë§¤í•‘ - `Mmap`*
	- fileì„ ë©”ëª¨ë¦¬ì²˜ëŸ¼ ì½ì„ ìˆ˜ ìˆê²Œ í•¨ 
	  
5. *3ë²ˆì—ì„œ ì–»ì€ ì‹ë³„ìë¥¼ ë‹«ëŠ”ë‹¤*
	- 4ë²ˆì—ì„œ ê°€ìƒë©”ëª¨ë¦¬ë¡œ mappingí–ˆìœ¼ë‹ˆ íŒŒì¼ ë°ì´í„°ë¥¼ ì½ëŠ” ë° fdê°€ í•„ìš”ê°€ ì—†ì–´ì§„ë‹¤
	- **Closeí•˜ëŠ” ì´ìœ ** 
		- ì‹ë³„ìëŠ” ë‹¨ìˆœíˆ ìˆ«ìê°€ ì•„ë‹ˆë¼, **ì»¤ë„ì— ìˆëŠ” íŒŒì¼ ê°ì²´ë¥¼ ê°€ë¦¬í‚¤ëŠ” í•¸ë“¤**ì´ë‹¤.
		- ì²˜ìŒì— ì»¤ë„ì€ íŒŒì¼ì„ Opení•˜ê³  í•´ë‹¹ íŒŒì¼ ìƒíƒœë¥¼ ë‹´ì€ êµ¬ì¡°ì²´(open file entry)ë¥¼ í•˜ë‚˜ ë§Œë“  ìƒíƒœì¸ ê²ƒ 
		- ë§Œì•½, ì´ **Close ì‘ì—…ì„ í•˜ì§€ ì•Šìœ¼ë©´** í•´ë‹¹ êµ¬ì¡°ì²´(ì—”íŠ¸ë¦¬)ê°€ ì»¤ë„ í…Œì´ë¸”ì— í•´ë‹¹ êµ¬ì¡°ì²´ê°€ ë‚¨ì•„ ìˆì–´ì„œ **ë¦¬ì†ŒìŠ¤ ëˆ„ìˆ˜ê°€ ìƒê¹€** 
	  
6. *ê°€ìƒë©”ëª¨ë¦¬ ë§¤í•‘ì„ ë°”íƒ•ìœ¼ë¡œ ì†Œì¼“ì— fileë‚´ìš©ì„ í˜ë ¤ë³´ë‚¸ë‹¤*
7. *4ë²ˆì—ì„œ ë§¤í•‘í•œ ê²ƒì„ í•´ì œí•˜ê³  ë¦¬ì†ŒìŠ¤ë¥¼ ë°˜í™˜í•œë‹¤*


>[!tip] êµ³ì´ ê°€ìƒ ë©”ëª¨ë¦¬ ë§¤í•‘í•˜ëŠ” ì´ìœ  
>1. *âŒë©”ëª¨ë¦¬ ë§¤í•‘ì„ ì•ˆ í•œë‹¤ë©´?*
>	- `while (n = read(~~~) > 0` ì´ëŸ° ë¡œì§ì„ ì§œë©´ì„œ ì—¬ëŸ¬ ë²ˆì˜ `read()`/`write()`ë¥¼ ë°˜ë³µí•  ê²ƒì´ë‹¤.
>	- ì´ë¡œ ì¸í•´ ìˆ˜ë§ì€ System Call ë°œìƒ ğŸ˜
>	  
>2. *âœ…ë©”ëª¨ë¦¬ ë§¤í•‘ì„ í•œë‹¤ë©´?*
>	- í”„ë¡œì„¸ìŠ¤ ì…ì¥ì—ì„œëŠ” **fileì´ ê·¸ëƒ¥ ì—°ì†ëœ ê¸´ ë°°ì—´ë¡œ ë³´ì´ê¸° ë•Œë¬¸**ì— `read()`ì—†ì´ ë°”ë¡œ `write()`ë¡œ íŒŒì¼ ë‚´ìš©ì„ ì†Œì¼“ì— í˜ë ¤ë³´ë‚¼ ìˆ˜ ìˆë‹¤.
>	- í˜ì´ì§€ ìºì‹œë¥¼ ì´ìš©í•´ì„œ System Callì„ ì—¬ëŸ¬ ë²ˆ í•  í•„ìš”ê°€ ì—†ë‹¤

---
#### serve_dynamic()
> ë™ì  ì»¨í…ì¸ ë¥¼ í´ë¼ì´ì–¸íŠ¸ì— ì œê³µí•˜ëŠ” í•¨ìˆ˜ 
> - ë©”ì¸ ë¡œì§ì€ ì„œë²„ ë§ê³  **ë‹¤ë¥¸ í”„ë¡œê·¸ë¨(CGI)ì´ ì²˜ë¦¼** 

![Pasted image 20250831115625.png](/img/user/supporter/image/Pasted%20image%2020250831115625.png)
```c
void serve_dynamic(int fd, char *filename, char *cgiargs){

Â  char buf[MAXLINE], *emptylist[] = {NULL};
Â  sprintf(buf, "HTTP/1.0 200 OK\r\n");
Â  sprintf(buf, "%sServer: Tiny Web Server\r\n", buf);
Â  // 1 
Â  Rio_writen(fd, buf, strlen(buf));

	// 2
Â  if (fork() == 0){
Â  Â  /** 3
Â  Â  Â * setenv ì´ìœ 
Â  Â  Â * - Excecveì˜ environì€ ë°©ê¸ˆ ì„¤ì •í•œ í™˜ê²½ì„ í¬í•¨í•˜ëŠ”ë°,
Â  Â  Â * - CGI ë‚´ë¶€ì—ì„œ getenv("QUERY_STRING")ìœ¼ë¡œ ê°’ì„ ì½ì„ ìˆ˜ ìˆë‹¤.
Â  Â  Â * - QUERY_STRING : ?ë’¤ì˜ ì¿¼ë¦¬ ë¬¸ìì—´ valueë¥¼ ë‹´ëŠ” í‚¤
Â  Â  Â */
Â  Â  setenv("QUERY_STRING", cgiargs, 1);

Â  Â  /** 4
Â  Â  Â * Dup2(oldfd, newfd)
Â  Â  Â * - ì •ì˜ : newfdë¥¼ oldfd(í´ë¼ ì†Œì¼“)ì˜ ë³µì‚¬ë³¸ìœ¼ë¡œ ë§Œë“ ë‹¤.
Â  Â  Â * - íš¨ê³¼ : CGI í”„ë¡œê·¸ë¨ì´ í‘œì¤€ì¶œë ¥ìœ¼ë¡œ ì“°ëŠ” ëª¨ë“  ë°ì´í„°ê°€ ê³§ë°”ë¡œ oldfdë¡œ ì „ì†¡ë¨
Â  Â  Â * - STDIN_FILENO = 1 Â by unistd.h
Â  Â  Â */
Â  Â  Dup2(fd, STDOUT_FILENO);
Â  Â  /** 5
Â  Â  Â * CGI ì‹¤í–‰ ë° í”„ë¡œì„¸ìŠ¤ ì´ë¯¸ì§€ êµì²´
Â  Â  Â * - path : ì‹¤í–‰í•  ìŠ¤í¬ë¦½íŠ¸ì˜ ê²½ë¡œ(CGI í”„ë¡œê·¸ë¨ì˜ ê²½ë¡œ)
Â  Â  Â * - environ : í˜„ì¬ í”„ë¡œì„¸ìŠ¤ì˜ í™˜ê²½ í¬ì¸í„°
Â  Â  Â */
Â  Â  Execve(filename, emptylist, environ);
Â  }
	/* 6 ì´ê±¸ í˜¸ì¶œí•œ í”„ë¡œì„¸ìŠ¤(ë¶€ëª¨)ì˜ ìì‹ í”„ë¡œì„¸ìŠ¤ê°€ ì¢…ë£Œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¼ */
Â  Wait(NULL);
```


1. *HTTP responseì˜ ì• ë¶€ë¶„ì„ ì§§ê²Œ `writen()`í•œë‹¤*
	- ìì„¸í•œê±°ëŠ” ë³µì œ í”„ë¡œì„¸ìŠ¤(CGI)ì—ì„œ ì²˜ë¦¬
	  
2. *ìì‹ í”„ë¡œì„¸ìŠ¤ë¥¼ ë³µì œí•œë‹¤ - `Fork()`*
	- í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ë¥¼ ë³µì œí•˜ëŠ” ã……ì‹œìŠ¤í…œ ì½œ 
	- Returnê°’ì€ ìì‹ í”„ë¡œì„¸ìŠ¤ì˜ PID (ì´ˆê¸°ì—ëŠ” 0)
	  
3. *ë³µì œí•œ ìì‹ í”„ë¡œì„¸ìŠ¤ì— í™˜ê²½ë³€ìˆ˜ë¥¼ ì£¼ì…í•œë‹¤ - `setenv()`*
4. *CGI í”„ë¡œê·¸ë¨ì˜ í‘œì¤€ ì¶œë ¥ì„ í´ë¼ì´ì–¸íŠ¸ ì†Œì¼“ì˜ ë³µì‚¬ë³¸ìœ¼ë¡œ ë§Œë“ ë‹¤* - `Dup2()` 
	- CGIì˜ í‘œì¤€ì¶œë ¥ì„ ì†Œì¼“ìœ¼ë¡œ ì—°ê²°í•˜ëŠ” ê²ƒ 
	- CGIê°€ í‘œì¤€ ì¶œë ¥ìœ¼ë¡œ ì“°ëŠ” ëª¨ë“  Byteê°€ ì†Œì¼“ìœ¼ë¡œ ì „ì†¡ë¨
	  
5. *CGI ì‹¤í–‰ ë° í”„ë¡œì„¸ìŠ¤ ì´ë¯¸ì§€ êµì²´ - `execve()*
	- í”„ë¡œì„¸ìŠ¤ë¥¼ **ë‹¤ë¥¸ í”„ë¡œê·¸ë¨ìœ¼ë¡œ êµì²´**í•œë‹¤.
	- `execve`
		- **ìƒˆë¡œìš´ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰**í•˜ê³  ë‹¤ë¥¸ í”„ë¡œê·¸ë¨ìœ¼ë¡œ **ê°ˆì•„ë¼ìš°ëŠ”** System call 
		- í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ì˜ code, data, stack, heapì„ **ìƒˆë¡œìš´ í”„ë¡œê·¸ë¨ì˜ codeì™€ dataë¡œ ì™„ì „ ëŒ€ì²´**í•œë‹¤.
		- ğŸ’¢But, ê¸°ì¡´ í”„ë¡œì„¸ìŠ¤ì˜ ì¼ë¶€(PID, í™˜ê²½ë³€ìˆ˜)ëŠ” ìœ ì§€ëœë‹¤.
	- *í•¨ìˆ˜ ë¶„ì„*
		```c
		execve(const char *path, char *const argv[], char *const envp[])
		```
		- *path* : **ì‹¤í–‰í• ** ë°”ì´ë„ˆë¦¬ or **ìŠ¤í¬ë¦½íŠ¸ì˜ ê²½ë¡œ**  ex. `./cgi-bin/adder, /usr/bin/python`
		- *argv* : ì¸ì ë¦¬ìŠ¤íŠ¸. argv[0]ì€ ê´€ë¡€ìƒ í”„ë¡œê·¸ë¨ ì´ë¦„
		- *envp* : í™˜ê²½ë³€ìˆ˜ ë¦¬ìŠ¤íŠ¸. ê·¸ëƒ¥ ì „ì—­ë³€ìˆ˜ì´ì **í˜„ì¬ í”„ë¡œì„¸ìŠ¤ì˜ í™˜ê²½ í¬ì¸í„°**ì¸ `environ` ë„˜ê¸°ë©´ í™˜ê²½ì´ ìƒˆ í”„ë¡œê·¸ë¨ì— ì „ë‹¬ë¨


	- `environ` : **í”„ë¡œì„¸ìŠ¤ ì „ì²´ì˜ í™˜ê²½ ë³€ìˆ˜ ëª©ë¡**ì„ ê°€ë¦¬í‚¤ëŠ” **ì „ì—­ ë³€ìˆ˜**.


>[!tip] í‘œì¤€ íŒ¨í„´ : fork â¡ ìì‹ í™˜ê²½ ì„¸íŒ… â¡ execve

>[!question] ë™ì  ì»¨í…ì¸  ì œê³µ ì‹œ fork()ë¡œ ìì‹ í”„ë¡œì„¸ìŠ¤ë¥¼ ë§Œë“œëŠ” ì´ìœ  
>- tiny ì„œë²„ëŠ” CGIë¡œ ë™ì  ì»¨í…ì¸ ë¥¼ ë‹¤ë£¨ëŠ”ë°, **CGIëŠ” ì„œë²„ ì½”ë“œì™€ ì™„ì „íˆ ë‹¤ë¥¸ ì‹¤í–‰ contextë¥¼ ê°€ì§„ í”„ë¡œê·¸ë¨**ì´ë‹¤.
>- ë§Œì•½, ì„œë²„ í”„ë¡œì„¸ìŠ¤ì—ì„œ CGIë¥¼ ì‹¤í–‰í•˜ë©´ **ì˜ëª»ëœ ê³µìœ (ì†Œì¼“ fd, buffer, ì£¼ì†Œ ê³µê°„ ë“±)ê°€ ì¼ì–´ë‚˜ ì¶©ëŒì´ ì¼ì–´ë‚  ìˆ˜ ìˆë‹¤.** ğŸ’¢
>- ì´ëŸ° ì¼ì„ ë°©ì§€í•˜ê³ ì, fork()ë¡œ ì„œë²„ í”„ë¡œì„¸ìŠ¤ë¥¼ ê·¸ëŒ€ë¡œ ë³µì œí•˜ê³ , ìì‹ í”„ë¡œì„¸ìŠ¤ë§Œ CGI í”„ë¡œê·¸ë¨ìœ¼ë¡œ ë®ì–´ì”Œìš°ëŠ” ê²ƒ 
>- ì´ë¡œ ì¸í•´, ìš”ì²­ ê´€ë¦¬í•˜ëŠ” ì„œë²„ í”„ë¡œì„¸ìŠ¤ì™€ ì‹¤í–‰í•˜ëŠ” CGI í”„ë¡œì„¸ìŠ¤ê°€ **ë¶„ë¦¬ë˜ì–´ ì•ˆì •ì„±ì´ ë†’ì•„ì§„ë‹¤**
>- `fork()` Return : -1 for errors, 0 to the new process



